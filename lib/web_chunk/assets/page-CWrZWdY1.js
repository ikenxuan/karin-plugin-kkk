import{s as j}from"./Combination-B21oHBYM.js";import{a as O,i as Q,n as Z,o as X,r as L,t as Y}from"./select-DERCp-hI.js";import{J as o,K as ee,Q as h,V as se,Z as w,_ as $,b as T,c as v,ct as P,d as f,f as g,l as N,n as l,p as m,r as te,rt as re,u as y,v as C,y as ae}from"./index-kqHhgqpo.js";import{n as le,r as ce,t as ne}from"./avatar-BgurYFRS.js";import{a as ie,i as oe,r as de,s as z,t as he}from"./request-BQBGNxsP.js";var me=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],xe=o("log-out",me),ue=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],H=o("monitor",ue),pe=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],V=o("moon",pe),je=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ve=o("save",je),fe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ge=o("shield",fe),Ne=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],A=o("sun",Ne),i=P(re()),e=P(se());function Ce(){const[s,n]=(0,i.useState)(""),[x,S]=(0,i.useState)(!1),[u,_]=(0,i.useState)(!1),{isDark:c,isSystem:p,isInverse:b,setSystemTheme:q,setInverseTheme:W,toggleTheme:D}=te();(0,i.useEffect)(()=>{n(localStorage.getItem("serverUrl")||"")},[]);const E=(0,i.useCallback)(()=>{u?(de(),oe(),ie(),window.location.href=(h(),h()?"/login":"/kkk/login")):(_(!0),l("再次点击确认退出登录",{icon:"⚠️",duration:3e3}),setTimeout(()=>{_(!1)},3e3))},[u]),F=async()=>{if(!s.trim())return l.error("请输入服务器地址"),!1;try{const a=new URL(s);if(a.pathname!=="/"||a.search||a.hash)return l.error("请输入有效的服务器地址，不应包含路径或参数"),!1}catch{return l.error("请输入有效的服务器地址格式"),!1}S(!0);const t=localStorage.getItem("serverUrl");let r=null;try{if(h()&&(r=await w("get_server_url"),await w("set_server_url",{url:s})),localStorage.setItem("serverUrl",s),(await he.serverGet("/api/v1/ping",{timeout:5e3})).ping==="pong")return l.success("服务器连接成功"),!0;throw new Error("服务器响应异常")}catch(a){return console.error("连接测试失败:",a),l.error("服务器连接失败"),t?localStorage.setItem("serverUrl",t):localStorage.removeItem("serverUrl"),h()&&r&&await w("set_server_url",{url:r}),!1}finally{S(!1)}},I=async()=>{if(!s.trim()){l.error("请输入服务器地址");return}const t=localStorage.getItem("serverUrl"),r=await F();if(t!==s){if(!r)return;localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userId"),setTimeout(()=>{l.error("后端服务已更改，请重新登录")},1e3),setTimeout(()=>{window.location.reload()},4e3)}localStorage.setItem("serverUrl",s)},R=(0,i.useCallback)(()=>{if(!s)return"";const t=s.startsWith("https://")?"https":"http",r=s.replace(/^https?:\/\//,"").replace(/:\d+$/,""),a=s.match(/:(\d+)$/)?.[1];return r?`${t}://${r}:${a||(t==="https"?"443":"7777")}`:""},[s]),K=()=>p?(0,e.jsx)(H,{className:"w-4 h-4"}):c?(0,e.jsx)(A,{className:"w-4 h-4"}):(0,e.jsx)(V,{className:"w-4 h-4"}),U=()=>c?"浅色模式":"深色模式",B=()=>p?`跟随系统 (当前: ${c?"深色":"浅色"})`:b?`智能切换 (当前: ${c?"深色":"浅色"})`:c?"深色模式":"浅色模式";return(0,e.jsx)(ae,{children:(0,e.jsx)("div",{className:"p-4 min-h-screen bg-background",children:(0,e.jsxs)("div",{className:"mx-auto space-y-6 max-w-2xl",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"关于我的"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"About Me"})]}),(0,e.jsxs)(m,{variant:u?"destructive":"outline",onClick:E,children:[(0,e.jsx)(xe,{className:"mr-2 w-4 h-4"}),u?"确认退出":"退出登录"]})]}),(0,e.jsxs)(v,{children:[(0,e.jsxs)(f,{children:[(0,e.jsx)(g,{children:"用户信息"}),(0,e.jsx)(y,{children:"当前登录用户的基本信息"})]}),(0,e.jsx)(N,{className:"space-y-4",children:(0,e.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,e.jsxs)(ne,{className:"w-20 h-20",children:[(0,e.jsx)(ce,{alt:"管理员头像"}),(0,e.jsx)(le,{children:(0,e.jsx)(ee,{className:"w-10 h-10"})})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-semibold",children:"管理员"}),(0,e.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,e.jsx)(ge,{className:"mr-1 w-4 h-4"}),(0,e.jsx)("span",{children:"系统管理员"})]})]})]})})]}),(0,e.jsxs)(v,{children:[(0,e.jsxs)(f,{children:[(0,e.jsx)(g,{children:"主题设置"}),(0,e.jsx)(y,{children:"选择您偏好的界面主题"})]}),(0,e.jsxs)(N,{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center",children:[(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsx)(j,{className:"text-sm font-medium",children:"当前主题"}),(0,e.jsx)("p",{className:"text-sm text-muted-foreground",children:B()})]}),(0,e.jsxs)($,{children:[(0,e.jsx)(T,{asChild:!0,children:(0,e.jsxs)(m,{variant:"outline",size:"sm",onClick:D,className:"flex gap-2 items-center",children:[K(),U()]})}),(0,e.jsx)(C,{children:(0,e.jsxs)("p",{children:["点击切换到",U()]})})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,e.jsxs)($,{children:[(0,e.jsx)(T,{asChild:!0,children:(0,e.jsxs)(m,{variant:p?"default":"outline",size:"sm",onClick:q,className:"flex gap-2 items-center",children:[(0,e.jsx)(H,{className:"w-4 h-4"}),"跟随系统"]})}),(0,e.jsx)(C,{children:(0,e.jsx)("p",{children:"主题会根据您的系统设置自动切换"})})]}),(0,e.jsxs)($,{children:[(0,e.jsx)(T,{asChild:!0,children:(0,e.jsxs)(m,{variant:b?"default":"outline",size:"sm",onClick:W,className:"flex gap-2 items-center",children:[c?(0,e.jsx)(A,{className:"w-4 h-4"}):(0,e.jsx)(V,{className:"w-4 h-4"}),"相反色"]})}),(0,e.jsx)(C,{children:(0,e.jsx)("p",{children:"与系统主题相反，系统是浅色时显示深色，系统是深色时显示浅色"})})]})]})]})]}),h()&&(0,e.jsxs)(v,{children:[(0,e.jsxs)(f,{children:[(0,e.jsx)(g,{children:"服务器设置"}),(0,e.jsx)(y,{children:"配置服务器连接地址"})]}),(0,e.jsxs)(N,{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(j,{htmlFor:"serverConfig",children:"服务器地址"}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)(j,{htmlFor:"protocol",className:"text-sm text-muted-foreground min-w-[40px]",children:"协议"}),(0,e.jsxs)(Y,{value:s.startsWith("https://")?"https":"http",onValueChange:t=>{n(`${t}://${s.replace(/^https?:\/\//,"").replace(/:\d+$/,"")}:${s.match(/:(\d+)$/)?.[1]||(t==="https"?"443":"7777")}`)},children:[(0,e.jsx)(Q,{className:"w-[100px]",children:(0,e.jsx)(O,{})}),(0,e.jsxs)(Z,{children:[(0,e.jsx)(L,{value:"http",children:"HTTP"}),(0,e.jsx)(L,{value:"https",children:"HTTPS"})]})]})]}),(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)(j,{htmlFor:"hostname",className:"text-sm text-muted-foreground min-w-[40px]",children:"地址"}),(0,e.jsxs)("div",{className:"relative flex-1",children:[(0,e.jsx)(X,{className:"absolute left-3 top-1/2 w-4 h-4 transform -translate-y-1/2 text-muted-foreground"}),(0,e.jsx)(z,{id:"hostname",type:"text",value:s.replace(/^https?:\/\//,"").replace(/:\d+$/,""),onChange:t=>{const r=t.target.value;if(r.includes("://")){const d=r.match(/(https?:\/\/[^\s]+)/);if(d){const G=d[1],k=new URL(G),M=k.protocol==="https:"?"https":"http",J=k.hostname;n(`${M}://${J}:${k.port||(M==="https"?"443":"7777")}`);return}}const a=s.startsWith("https://")?"https":"http";n(`${a}://${r}:${s.match(/:(\d+)$/)?.[1]||(a==="https"?"443":"7777")}`)},onKeyDown:t=>{t.key==="Enter"&&I()},className:"pl-9",placeholder:"localhost 或粘贴完整URL",disabled:x})]}),(0,e.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,e.jsx)("span",{className:"text-sm text-muted-foreground",children:":"}),(0,e.jsx)(z,{id:"port",type:"number",value:s.match(/:(\d+)$/)?.[1]||"",onChange:t=>{const r=t.target.value,a=s.startsWith("https://")?"https":"http",d=s.replace(/^https?:\/\//,"").replace(/:\d+$/,"");r.trim()?n(`${a}://${d}:${r}`):n(`${a}://${d}`)},className:"w-[80px]",placeholder:s.startsWith("https://")?"443":"7777",disabled:x,min:"1",max:"65535"})]})]}),s&&(0,e.jsxs)("div",{className:"p-2 text-xs rounded border text-muted-foreground bg-muted/50",children:["地址预览: ",R()]})]})]}),(0,e.jsxs)(m,{onClick:I,disabled:x,className:"w-full",children:[(0,e.jsx)(ve,{className:"mr-2 w-4 h-4"}),x?"测试连接中...":"保存并测试连接"]})]})]}),(0,e.jsxs)(v,{children:[(0,e.jsxs)(f,{children:[(0,e.jsx)(g,{children:"系统信息"}),(0,e.jsx)(y,{children:"关于本系统的基本信息"})]}),(0,e.jsxs)(N,{className:"space-y-2",children:[(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-muted-foreground",children:"版本"}),(0,e.jsxs)("span",{className:"text-sm font-medium",children:["v","2.8.0"]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-muted-foreground",children:"构建时间"}),(0,e.jsx)("span",{className:"text-sm font-medium",children:"2025/10/20 20:56 (UTC+0)"})]})]})]})]})})})}export{Ce as default};
